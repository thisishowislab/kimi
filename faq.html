
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>the manifestorium | faq</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Space+Grotesk:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        body { background: #050505; color: #e0e0e0; font-family: 'Space Grotesk', sans-serif; }
        .serif { font-family: 'Cinzel', serif; }
        .glass { background: rgba(255,255,255,0.03); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); }
        .gradient-text { background: linear-gradient(135deg, #fff 0%, #b026ff 50%, #00f3ff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .nav-link { position: relative; }
        .nav-link::after { content: ''; position: absolute; bottom: -4px; left: 0; width: 0; height: 1px; background: #00f3ff; transition: width 0.3s; }
        .nav-link:hover::after { width: 100%; }
        .answer { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .answer.open { max-height: 500px; }
        body.faq-flipped { transform: rotate(180deg); }
    </style>
</head>
<body class="min-h-screen pb-24">
  <div class="min-h-screen">
    <nav class="fixed top-0 w-full z-50 glass border-b border-white/10">
      <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
        <a href="/home.html" class="serif text-xl tracking-widest text-white">THE MANIFESTORIUM</a>

        <div class="hidden md:flex gap-8 text-sm tracking-widest uppercase items-center">
          <a href="/store.html" class="nav-link hover:text-cyan-400 transition">Artifacts</a>
          <a href="/tours.html" class="nav-link hover:text-cyan-400 transition">Tours</a>
          <a href="/field-notes.html" class="nav-link hover:text-cyan-400 transition">Field Notes</a>
          <a href="/donations.html" class="nav-link text-purple-400">Support</a>
          <a href="/faq.html" class="nav-link hover:text-cyan-400 transition">FAQ</a>
          <a href="/contact.html" class="nav-link hover:text-cyan-400 transition">Contact</a>
        </div>

        <button type="button" onclick="toggleMobileNav()" class="md:hidden text-white" aria-label="Open menu">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>
      </div>

      <div id="mobile-nav" class="hidden md:hidden border-t border-white/10 bg-black/95">
        <div class="px-6 py-4 space-y-4 text-sm uppercase tracking-widest">
          <a href="/store.html" class="block hover:text-cyan-400">Artifacts</a>
          <a href="/tours.html" class="block hover:text-cyan-400">Tours</a>
          <a href="/field-notes.html" class="block hover:text-cyan-400">Field Notes</a>
          <a href="/donations.html" class="block text-purple-400">Support</a>
          <a href="/faq.html" class="block hover:text-cyan-400">FAQ</a>
          <a href="/contact.html" class="block hover:text-cyan-400">Contact</a>
        </div>
      </div>
    </nav>

    <main class="pt-32 pb-24 px-6 max-w-3xl mx-auto">
      <h1 class="serif text-5xl mb-4 text-center gradient-text">Questions</h1>
      <p class="text-center text-gray-500 mb-10">Some answers. Not all of them useful.</p>

      <div class="space-y-4" id="faq-container"></div>
    </main>
  </div>

  <script>
    function toggleMobileNav() {
      const el = document.getElementById('mobile-nav');
      if (!el) return;
      el.classList.toggle('hidden');
    }
  </script>

  <script>
    (() => {
      const fallbackFaqs = [
        {
          q: "Is the bus actually bigger on the inside?",
          a: "Technically no, but perceptually yes. Portal 2 creates a recursive spatial loop that adds approximately 400 square feet of perceived volume. Bring a compass. It won't help, but bring one anyway.",
        },
        {
          q: "What do Mini Slabbers eat?",
          a: "Attention, mostly. But also dried apricots and small screws. Do not feed them after midnight. We don't know what happens, and we don't want to find out.",
        },
        {
          q: "Can I drive the bus?",
          a: "No. The bus drives itself when it wants to move. We haven't figured out how to stop it from relocating to the Salton Sea every third Tuesday. We just move our workshops.",
        },
        {
          q: "Are the portals dangerous?",
          a: "Only if you're not paying attention. Portal 5 temporarily inverted a visitor's gravity last month. He's fine now, but he has to wear weighted boots on Tuesdays.",
        },
        {
          q: "Do you have WiFi?",
          a: "We have Portal 6. It's faster than WiFi but requires you to think in binary. Your phone won't work here anyway. The Navy's radar interferes with everything except carrier pigeons.",
        },
        {
          q: "What's the deal with the bathroom?",
          a: "It's a composting toilet that opens to a pocket dimension. We don't know where it goes. Please don't put anything in it that you want to see again, including regrets.",
        },
        {
          q: "Can I live in the bus?",
          a: "You can try. Three people have. Two left voluntarily. One became a Mini Slabber. We don't talk about him, but he seems happy.",
        },
        {
          q: "Is this legal?",
          a: "Define legal. Define reality. Define 'is.' We pay taxes to the Salton Sea Authority, which may or may not exist.",
        },
      ];

      let faqs = [...fallbackFaqs];

      function normalizeFaqs(value) {
        const source = Array.isArray(value?.faqs) ? value.faqs : value;
        if (!Array.isArray(source)) return [];

        return source
          .map((item) => ({
            q: String(item?.q || item?.question || '').trim(),
            a: String(item?.a || item?.answer || '').trim(),
          }))
          .filter((item) => item.q && item.a);
      }

      function renderFaqs() {
        const container = document.getElementById('faq-container');
        if (!container) return;

        container.innerHTML = faqs
          .map(
            (faq, idx) => `
              <div class="glass rounded-lg cursor-pointer" data-faq-index="${idx}">
                <div class="p-6 flex justify-between items-center">
                  <h3 class="text-lg text-white pr-8">${faq.q}</h3>
                  <span class="text-cyan-400 text-2xl transition-transform duration-300" id="icon-${idx}">+</span>
                </div>
                <div class="answer px-6 pb-6 text-gray-400 leading-relaxed" id="answer-${idx}">
                  ${faq.a}
                </div>
              </div>
            `
          )
          .join('');
      }

      function shuffleFaqs() {
        faqs = [...faqs]
          .map((faq) => ({ sortKey: Math.random(), faq }))
          .sort((a, b) => a.sortKey - b.sortKey)
          .map((entry) => entry.faq);

        renderFaqs();
      }

      function applyMonthlyFlip() {
        const now = new Date();
        document.body.classList.toggle('faq-flipped', now.getDate() === 20);
      }

      function toggleFaq(idx) {
        const answer = document.getElementById(`answer-${idx}`);
        const icon = document.getElementById(`icon-${idx}`);
        if (!answer || !icon) return;

        const open = answer.classList.contains('open');

        document.querySelectorAll('.answer').forEach((el) => el.classList.remove('open'));
        document.querySelectorAll('[id^="icon-"]').forEach((el) => {
          el.style.transform = 'rotate(0deg)';
        });

        if (!open) {
          answer.classList.add('open');
          icon.style.transform = 'rotate(45deg)';
        }
      }

      async function loadFaqs() {
        try {
          const response = await fetch('/data/faq.json', { cache: 'no-store' });
          if (response.ok) {
            const payload = await response.json();
            const loadedFaqs = normalizeFaqs(payload);
            if (loadedFaqs.length) faqs = loadedFaqs;
          }
        } catch (error) {
          console.error('Falling back to built-in FAQ content:', error);
        }

        renderFaqs();
      }

      function init() {
        const container = document.getElementById('faq-container');
        if (!container) return;

        container.addEventListener('click', (event) => {
          const card = event.target.closest('[data-faq-index]');
          if (!card) return;
          toggleFaq(Number(card.dataset.faqIndex));
        });

        window.addEventListener('pageshow', shuffleFaqs);
        window.addEventListener('popstate', shuffleFaqs);

        applyMonthlyFlip();
        loadFaqs().then(shuffleFaqs);
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }
    })();
  </script>
</body>
</html>
